# 🚀 视觉摄像头分析功能 - 快速开始指南

## 📋 准备清单

在开始之前，请确保您已经准备好以下条件：

- ✅ 已部署并运行的小智面包板服务端
- ✅ 已配置并可正常使用的ONVIF摄像头
- ✅ 火山引擎账号（用于申请豆包视觉模型API）

## ⚡ 5分钟快速配置

### 步骤1: 申请豆包视觉模型API密钥 (2分钟)

1. 访问 [火山引擎控制台](https://console.volcengine.com/ark/region:ark+cn-beijing/openManagement)
2. 搜索 `doubao-vision-pro-32k` 并点击开通
3. 前往 [API密钥页面](https://console.volcengine.com/ark/region:ark+cn-beijing/apiKey) 创建密钥
4. 复制生成的API密钥

### 步骤2: 更新配置文件 (1分钟)

打开 `main/xiaozhi-server/data/.config.yaml` 文件，找到这一行：
```yaml
api_key: 你的doubao_vision_api_key
```
将 `你的doubao_vision_api_key` 替换为步骤1中获取的真实API密钥。

### 步骤3: 重启服务 (1分钟)

重启小智服务端以加载新配置：
```bash
# 如果使用Docker
docker restart xiaozhi-esp32-server

# 如果使用源码部署
# 停止当前服务并重新启动
```

### 步骤4: 测试功能 (1分钟)

对着小智说：
> "帮我看下卧室现在有几个人"

等待小智回复分析结果！

## 🎯 预期效果

**用户说**："帮我看下卧室现在有几个人"

**小智回复**：
> "好的，正在为您抓拍卧室画面进行分析... 
> 
> 📷 摄像头抓拍完成：已成功抓拍卧室摄像头的画面，保存为 卧室_20250115_143052.jpg，文件大小 248KB
> 
> 🔍 视觉分析结果：
> 根据图片分析，卧室里现在有1个人。这个人坐在床边，穿着休闲服装。房间光线充足，环境整洁。"

## 🔧 常用语音指令

### 基础功能测试
```
"帮我看下卧室现在有几个人"
"检查卧室有什么东西"
"分析一下卧室的情况"
```

### 进阶功能
```
"检查卧室有没有异常"
"卧室的灯开着吗"
"窗户是开着还是关着的"
```

## ❗ 常见问题快速解决

### 问题1: "未配置默认的视觉分析模块"
**解决**：确认 `.config.yaml` 中有以下配置：
```yaml
selected_module:
  VLLM: DoubaoVLLM
```

### 问题2: "摄像头不在支持列表中"
**解决**：检查摄像头别名是否正确，确保 `.config.yaml` 中：
```yaml
plugins:
  vision_camera_analysis:
    supported_cameras:
      - "卧室摄像头"  # 这里的名称要与onvif_camera配置中的alias一致
```

### 问题3: API调用失败
**解决**：
1. 检查API密钥是否正确
2. 确认火山引擎账户余额充足
3. 验证网络连接是否正常

## 📞 获取更多帮助

- 📖 **详细文档**：查看 `VISION_CAMERA_ANALYSIS_SETUP.md`
- 🐛 **问题反馈**：在项目Issues中提交问题
- 💬 **社区支持**：加入项目讨论群

---

**提示**：如果首次使用遇到问题，建议先单独测试摄像头抓拍功能：
> "抓拍一张卧室的照片"

确认摄像头工作正常后，再测试视觉分析功能。 